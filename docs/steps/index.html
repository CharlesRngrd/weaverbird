<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/font-awesome.min.css">

    <link rel="shortcut icon" href="/favicon.ico?1">
    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Steps | Weaverbird</title>
<meta name="generator" content="Jekyll v3.8.4" />
<meta property="og:title" content="Steps" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Steps definition" />
<meta property="og:description" content="Steps definition" />
<link rel="canonical" href="https://weaverbird.toucantoco.com/docs/steps/" />
<meta property="og:url" content="https://weaverbird.toucantoco.com/docs/steps/" />
<meta property="og:site_name" content="Weaverbird" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-14T17:39:27+02:00" />
<script type="application/ld+json">
{"url":"https://weaverbird.toucantoco.com/docs/steps/","headline":"Steps","datePublished":"2020-08-14T17:39:27+02:00","dateModified":"2020-08-14T17:39:27+02:00","description":"Steps definition","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="canonical" href="https://weaverbird.toucantoco.com/docs/steps/">
    <link rel="alternate" type="application/rss+xml" title="Weaverbird" href="https://weaverbird.toucantoco.com/feed.xml" />
</head>


<body>

    <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container navbar-container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
            <a class="navbar-brand" href="/">Weaverbird</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li  class="active" ><a href="/docs/steps/">Docs</a></li>
                <!-- remove for the moment
                  <li ><a href="">Blog</a></li> -->
                <li ><a href="/about">About</a></li>
            </ul>
            <div class="navbar-right">
                <form class="navbar-form navbar-left">
                    <!-- <div class="form-group has-feedback">
                        <input id="search-box" type="search" class="form-control" placeholder="Search...">
                        <i class="fa fa-search form-control-feedback"></i>
                    </div> -->
                </form>
                <ul class="nav navbar-nav">
                    <li><a href="https://github.com/ToucanToco/weaverbird"><i class="fa fa-github" aria-hidden="true"></i></a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>


    <div class="page-content">
        <div class="wrapper">
            <div class="container">
    <div class="row">
        <div class="col-md-4">
          <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
  
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title">
          <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-1" aria-expanded="false" aria-controls="collapse-1">
            User interface
          </a>
        </h4>
      </div>
      
      
      <div class="panel-collapse collapse" id="collapse-1" role="tabpanel" aria-label="Side Navigation">
        <div class="list-group">
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/general-principles/">General Principles</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/text/">Add text column</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/aggregate/">Aggregate</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/append/">Append</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/argmax/">Argmax</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/argmin/">Argmin</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/concatenate/">Concatenate columns</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/convert/">Convert</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/fromdate/">Convert date to text</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/todate/">Convert text to date</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/cumsum/">Cumulated sum</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/custom/">Cutom step</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/delete/">Delete column(s)</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/duplicate/">Duplicate</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/evolution/">Evolution</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/dateextract/">Extract date property</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/substring/">Extract substring</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/fillna/">Fill null</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/filter/">Filter</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/formula/">Formula</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/uniquegroups/">Get unique groups/values</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/rollup/">Hierarchical rollup</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/ifthenelse/">ifthenelse</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/join/">Join</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/select/">Keep column(s)</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/percentage/">Percentage</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/pivot/">Pivot</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/rename/">Rename</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/replace/">Replace</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/sort/">Sort</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/split/">Split column</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/statistics/">Column's Statistics</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/lowercase/">To lowercase</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/uppercase/">To uppercase</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/top/">Top N rows</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/unpivot/">Unpivot</a>
            <!--  -->
          
        </div>
      </div>
    </div>
  
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title">
          <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-2" aria-expanded="false" aria-controls="collapse-2">
            Technical documentation
          </a>
        </h4>
      </div>
      
      
      <div class="panel-collapse" id="collapse-2" role="tabpanel" aria-label="Side Navigation">
        <div class="list-group">
          
            
            
            <!-- 
              <a class="list-group-item " href="https://weaverbird.toucantoco.com">index</a>
             -->
          
            
            
            <!--  -->
              <a class="list-group-item active" href="/docs/steps/">Steps</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/new-step/">Designing a new step</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/known-limitations/">Known limitations</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/translators/">Translators</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/variables/">Variables</a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/ui-components/"></a>
            <!--  -->
          
            
            
            <!--  -->
              <a class="list-group-item " href="/docs/code-editor/">Custom code editor</a>
            <!--  -->
          
        </div>
      </div>
    </div>
  
</div>

        </div>

        <div class="col-md-8">
            <div id="markdown-content-container"><h2 id="steps-definition">Steps definition</h2>

<p>This document describes the steps that can be used in our pipelines. A step is
the unit of transformation generated by a user interaction with the visual query
builder.</p>

<p>Unless explicitly specified, all steps are supported by all backends.</p>

<h3 id="aggregate-step"><code class="highlighter-rouge">aggregate</code> step</h3>

<p>Perform aggregations on one or several columns.</p>

<p>An aggreation step has the following strucure:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
   <span class="nl">name</span><span class="p">:</span> <span class="s1">'aggregate'</span><span class="p">,</span>
   <span class="nx">on</span><span class="p">:</span> <span class="p">[</span><span class="s1">'column1'</span><span class="p">,</span> <span class="s1">'column2'</span><span class="p">],</span>
   <span class="nx">aggregations</span><span class="p">:</span>  <span class="p">[</span>
      <span class="p">{</span>
          <span class="na">newcolumn</span><span class="p">:</span> <span class="s1">'sum_value1'</span><span class="p">,</span>
          <span class="na">aggfunction</span><span class="p">:</span> <span class="s1">'sum'</span><span class="p">,</span>
          <span class="na">column</span><span class="p">:</span> <span class="s1">'value1'</span>
      <span class="p">}</span>
    <span class="c1">// ...</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example">Example:</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'aggregate'</span><span class="p">,</span>
   <span class="nx">on</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Group'</span><span class="p">],</span>
   <span class="nx">aggregations</span><span class="p">:</span>  <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">newcolumn</span><span class="p">:</span> <span class="s1">'Total'</span><span class="p">,</span>
      <span class="na">aggfunction</span><span class="p">:</span> <span class="s1">'sum'</span><span class="p">,</span>
      <span class="na">column</span><span class="p">:</span> <span class="s1">'Value'</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Group</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Group 1</td>
      <td>30</td>
    </tr>
    <tr>
      <td>Group 2</td>
      <td>16</td>
    </tr>
  </tbody>
</table>

<h3 id="append-step"><code class="highlighter-rouge">append</code> step</h3>

<p>Appends to the current dataset, one or several datasets resulting from other
<code class="highlighter-rouge">pipelines</code>.
WeaverBird allows you to save <code class="highlighter-rouge">pipelines</code> referenced by name in the Vuex store
of the application. You can then call them by their unique names in this step.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'append'</span><span class="p">,</span>
  <span class="nx">pipelines</span><span class="p">:</span> <span class="p">[</span><span class="s1">'pipeline1'</span><span class="p">,</span> <span class="s1">'pipeline2'</span><span class="p">]</span> <span class="c1">// the name of the pipelines to append</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-1">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
  </tbody>
</table>

<p><strong>dataset1 (saved in the application Vuex store)</strong>:</p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p><strong>dataset2 (saved in the application Vuex store)</strong>:</p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'append'</span><span class="p">,</span>
  <span class="nx">datasets</span><span class="p">:</span> <span class="p">[</span><span class="s1">'dataset1'</span><span class="p">,</span> <span class="s1">'dataset2'</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<h3 id="argmax-step"><code class="highlighter-rouge">argmax</code> step</h3>

<p>Get row(s) matching the maximum value in a given <code class="highlighter-rouge">column</code>, by group if <code class="highlighter-rouge">groups</code>
is specified.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'argmax'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'value'</span><span class="p">,</span> <span class="c1">// column in which to search for max value</span>
  <span class="nx">groups</span><span class="p">:</span> <span class="p">[</span><span class="s1">'group1'</span><span class="p">,</span> <span class="s1">'group2'</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-1-without-groups">Example 1: without <code class="highlighter-rouge">groups</code></h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'argmax'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Value'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
  </tbody>
</table>

<h4 id="example-2-with-groups">Example 2: with <code class="highlighter-rouge">groups</code></h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'argmax'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Value'</span><span class="p">,</span>
  <span class="nx">groups</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Group'</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
  </tbody>
</table>

<h3 id="argmin-step"><code class="highlighter-rouge">argmin</code> step</h3>

<p>Get row(s) matching the minimum value in a given <code class="highlighter-rouge">column</code>, by group if <code class="highlighter-rouge">groups</code>
is specified.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'argmin'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'value'</span><span class="p">,</span> <span class="c1">// column in which to search for max value</span>
  <span class="nx">groups</span><span class="p">:</span> <span class="p">[</span><span class="s1">'group1'</span><span class="p">,</span> <span class="s1">'group2'</span><span class="p">]</span> <span class="c1">// optional</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-1-without-groups-1">Example 1: without <code class="highlighter-rouge">groups</code></h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'argmin'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Value'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
  </tbody>
</table>

<h4 id="example-2-with-groups-1">Example 2: with <code class="highlighter-rouge">groups</code></h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'argmin'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Value'</span><span class="p">,</span>
  <span class="nx">groups</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Groups'</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<h3 id="concatenate-step"><code class="highlighter-rouge">concatenate</code> step</h3>

<p>This step allows to concatenate several <code class="highlighter-rouge">columns</code> using a <code class="highlighter-rouge">separator</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'concatenate'</span><span class="p">,</span>
  <span class="nx">columns</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Company'</span><span class="p">,</span> <span class="s1">'Group'</span><span class="p">]</span>
  <span class="nx">separator</span><span class="p">:</span> <span class="s1">' - '</span> <span class="c1">// can be a string of any length</span>
  <span class="nx">new_column_name</span><span class="p">:</span> <span class="s1">'Label'</span> <span class="c1">// The new column in which to write the concatenation</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-2">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Company 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Company 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Company 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Company 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'concatenate'</span><span class="p">,</span>
  <span class="nx">columns</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Company'</span><span class="p">,</span> <span class="s1">'Group'</span><span class="p">]</span>
  <span class="nx">separator</span><span class="p">:</span> <span class="s1">' - '</span>
  <span class="nx">new_column_name</span><span class="p">:</span> <span class="s1">'Label'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Group</th>
      <th>Value</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>Group 1</td>
      <td>13</td>
      <td>Company 1 - Group 1</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>Group 1</td>
      <td>7</td>
      <td>Company 2 - Group 1</td>
    </tr>
    <tr>
      <td>Company 3</td>
      <td>Group 1</td>
      <td>20</td>
      <td>Company 3 - Group 1</td>
    </tr>
    <tr>
      <td>Company 4</td>
      <td>Group 2</td>
      <td>1</td>
      <td>Company 4 - Group 2</td>
    </tr>
    <tr>
      <td>Company 5</td>
      <td>Group 2</td>
      <td>10</td>
      <td>Company 5 - Group 2</td>
    </tr>
    <tr>
      <td>Company 6</td>
      <td>Group 2</td>
      <td>5</td>
      <td>Company 6 - Group 2</td>
    </tr>
  </tbody>
</table>

<h3 id="convert-step"><code class="highlighter-rouge">convert</code> step</h3>

<p>This step allows to convert <code class="highlighter-rouge">columns</code> data types.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'convert'</span><span class="p">,</span>
  <span class="nx">columns</span><span class="p">:</span> <span class="p">[</span><span class="s1">'col1'</span><span class="p">,</span> <span class="s1">'col2'</span><span class="p">]</span>
  <span class="nx">data_type</span><span class="p">:</span> <span class="s1">'integer'</span> <span class="c1">// The data type to convert the column into. Can be either</span>
                       <span class="c1">// 'integer', 'float', 'text', 'date' or 'boolean'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
</ul>

<h4 id="example-3">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>‘13’</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>‘7’</td>
    </tr>
    <tr>
      <td>Company 3</td>
      <td>‘20’</td>
    </tr>
    <tr>
      <td>Company 4</td>
      <td>‘1’</td>
    </tr>
    <tr>
      <td>Company 5</td>
      <td>‘10’</td>
    </tr>
    <tr>
      <td>Company 6</td>
      <td>‘5’</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'convert'</span><span class="p">,</span>
  <span class="nx">columns</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Value'</span><span class="p">]</span>
  <span class="nx">data_type</span><span class="p">:</span> <span class="s1">'integer'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Company 3</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Company 4</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Company 5</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Company 6</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<h3 id="cumsum-step"><code class="highlighter-rouge">cumsum</code> step</h3>

<p>This step allows to compute the cumulated sum of value column based on a
reference column (usually dates) to be sorted by ascending order for the needs
of the computation. The computation can be scoped by group if needed.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'cumsum'</span><span class="p">,</span>
  <span class="nx">valueColumn</span><span class="p">:</span> <span class="s1">'myValues'</span><span class="p">,</span>
  <span class="nx">referenceColumn</span><span class="p">:</span> <span class="s1">'myDates'</span><span class="p">,</span>
  <span class="nx">groupby</span><span class="p">:</span> <span class="p">[</span><span class="s1">'foo'</span><span class="p">,</span> <span class="s1">'bar'</span><span class="p">],</span>
  <span class="nx">newColumn</span><span class="p">:</span> <span class="s1">'myCumsum'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-1-basic-usage">Example 1: Basic usage</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>DATE</th>
      <th>VALUE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2019-01</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2019-02</td>
      <td>5</td>
    </tr>
    <tr>
      <td>2019-03</td>
      <td>3</td>
    </tr>
    <tr>
      <td>2019-04</td>
      <td>8</td>
    </tr>
    <tr>
      <td>2019-05</td>
      <td>9</td>
    </tr>
    <tr>
      <td>2019-06</td>
      <td>6</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'cumsum'</span><span class="p">,</span>
  <span class="nx">valueColumn</span><span class="p">:</span> <span class="s1">'VALUE'</span><span class="p">,</span>
  <span class="nx">referenceColumn</span><span class="p">:</span> <span class="s1">'DATE'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>DATE</th>
      <th>VALUE</th>
      <th>VALUE_CUMSUM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2019-01</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2019-02</td>
      <td>5</td>
      <td>7</td>
    </tr>
    <tr>
      <td>2019-03</td>
      <td>3</td>
      <td>10</td>
    </tr>
    <tr>
      <td>2019-04</td>
      <td>8</td>
      <td>18</td>
    </tr>
    <tr>
      <td>2019-05</td>
      <td>9</td>
      <td>27</td>
    </tr>
    <tr>
      <td>2019-06 6</td>
      <td>6</td>
      <td>33</td>
    </tr>
  </tbody>
</table>

<h4 id="example-2-with-more-advanced-options">Example 2: With more advanced options</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>COUNTRY</th>
      <th>DATE</th>
      <th>VALUE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>France</td>
      <td>2019-01</td>
      <td>2</td>
    </tr>
    <tr>
      <td>France</td>
      <td>2019-02</td>
      <td>5</td>
    </tr>
    <tr>
      <td>France</td>
      <td>2019-03</td>
      <td>3</td>
    </tr>
    <tr>
      <td>France</td>
      <td>2019-04</td>
      <td>8</td>
    </tr>
    <tr>
      <td>France</td>
      <td>2019-05</td>
      <td>9</td>
    </tr>
    <tr>
      <td>France</td>
      <td>2019-06 6</td>
      <td>6</td>
    </tr>
    <tr>
      <td>USA</td>
      <td>2019-01</td>
      <td>10</td>
    </tr>
    <tr>
      <td>USA</td>
      <td>2019-02</td>
      <td>6</td>
    </tr>
    <tr>
      <td>USA</td>
      <td>2019-03</td>
      <td>6</td>
    </tr>
    <tr>
      <td>USA</td>
      <td>2019-04</td>
      <td>4</td>
    </tr>
    <tr>
      <td>USA</td>
      <td>2019-05</td>
      <td>8</td>
    </tr>
    <tr>
      <td>USA</td>
      <td>2019-06 6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'cumsum'</span><span class="p">,</span>
  <span class="nx">valueColumn</span><span class="p">:</span> <span class="s1">'VALUE'</span><span class="p">,</span>
  <span class="nx">referenceColumn</span><span class="p">:</span> <span class="s1">'DATE'</span><span class="p">,</span>
  <span class="nx">groupby</span><span class="p">:</span> <span class="p">[</span><span class="s1">'COUNTRY'</span><span class="p">],</span>
  <span class="nx">newColumn</span><span class="p">:</span> <span class="s1">'MY_CUMSUM'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>COUNTRY</th>
      <th>DATE</th>
      <th>VALUE</th>
      <th>MY_CUMSUM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>France</td>
      <td>2019-01</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <td>France</td>
      <td>2019-02</td>
      <td>5</td>
      <td>7</td>
    </tr>
    <tr>
      <td>France</td>
      <td>2019-03</td>
      <td>3</td>
      <td>10</td>
    </tr>
    <tr>
      <td>France</td>
      <td>2019-04</td>
      <td>8</td>
      <td>18</td>
    </tr>
    <tr>
      <td>France</td>
      <td>2019-05</td>
      <td>9</td>
      <td>27</td>
    </tr>
    <tr>
      <td>France</td>
      <td>2019-06 6</td>
      <td>6</td>
      <td>33</td>
    </tr>
    <tr>
      <td>USA</td>
      <td>2019-01</td>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <td>USA</td>
      <td>2019-02</td>
      <td>6</td>
      <td>16</td>
    </tr>
    <tr>
      <td>USA</td>
      <td>2019-03</td>
      <td>6</td>
      <td>22</td>
    </tr>
    <tr>
      <td>USA</td>
      <td>2019-04</td>
      <td>4</td>
      <td>26</td>
    </tr>
    <tr>
      <td>USA</td>
      <td>2019-05</td>
      <td>8</td>
      <td>34</td>
    </tr>
    <tr>
      <td>USA</td>
      <td>2019-06 6</td>
      <td>7</td>
      <td>41</td>
    </tr>
  </tbody>
</table>

<h3 id="custom-step"><code class="highlighter-rouge">custom</code> step</h3>

<p>This step allows to define a custom query that can’t be expressed using the
other existing steps.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'custom'</span><span class="p">,</span>
    <span class="nx">query</span><span class="p">:</span> <span class="s1">'$group: {_id: ...}'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-using-mongo-query-language">Example: using Mongo query language</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Company 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Company 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Company 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Company 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'custom'</span><span class="p">,</span>
  <span class="nx">query</span><span class="p">:</span> <span class="s1">'$addFields: { Label: { $concat: [ "$Label", " - ", "$Group" ] ] } }'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Group</th>
      <th>Value</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>Group 1</td>
      <td>13</td>
      <td>Company 1 - Group 1</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>Group 1</td>
      <td>7</td>
      <td>Company 2 - Group 1</td>
    </tr>
    <tr>
      <td>Company 3</td>
      <td>Group 1</td>
      <td>20</td>
      <td>Company 3 - Group 1</td>
    </tr>
    <tr>
      <td>Company 4</td>
      <td>Group 2</td>
      <td>1</td>
      <td>Company 4 - Group 2</td>
    </tr>
    <tr>
      <td>Company 5</td>
      <td>Group 2</td>
      <td>10</td>
      <td>Company 5 - Group 2</td>
    </tr>
    <tr>
      <td>Company 6</td>
      <td>Group 2</td>
      <td>5</td>
      <td>Company 6 - Group 2</td>
    </tr>
  </tbody>
</table>

<h3 id="dateextract-step"><code class="highlighter-rouge">dateextract</code> step</h3>

<p>Extract a part of a date (e.g. <em>day</em>, <em>week</em>, <em>year</em>) <code class="highlighter-rouge">column</code>. The following properties
can be extracted:</p>

<ul>
  <li><code class="highlighter-rouge">year'</code>: extract ‘year’ from date,</li>
  <li><code class="highlighter-rouge">month'</code>: extract ‘month’ from date,</li>
  <li><code class="highlighter-rouge">day'</code>: extract ‘day of month’ from date,</li>
  <li><code class="highlighter-rouge">hour'</code>: extract ‘hour’ from date,</li>
  <li><code class="highlighter-rouge">minutes'</code>: extract ‘minutes’ from date,</li>
  <li><code class="highlighter-rouge">seconds'</code>: extract ‘seconds’ from date,</li>
  <li><code class="highlighter-rouge">milliseconds'</code>: extract ‘milliseconds’ from date,</li>
  <li><code class="highlighter-rouge">dayOfYear'</code>: extract ‘day of year’ from date,</li>
  <li><code class="highlighter-rouge">dayOfWeek'</code>: extract ‘day of week’ from date,</li>
  <li><code class="highlighter-rouge">week'</code>: extract ‘week number’ from date.</li>
</ul>

<p>Here’s an example of such a step:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'dateextract'</span><span class="p">,</span>
    <span class="nx">column</span><span class="p">:</span> <span class="s1">'date'</span><span class="p">,</span>
    <span class="nx">operation</span><span class="p">:</span> <span class="s1">'day'</span><span class="p">,</span>
    <span class="nx">new_column_name</span><span class="p">:</span> <span class="s1">'date_day'</span><span class="p">,</span>
    <span class="nx">format</span><span class="p">:</span> <span class="s1">'%Y-%m-%d'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-4">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>2019-10-06T00:00:00.000Z</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>2019-10-07T00:00:00.000Z</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>2019-10-08T00:00:00.000Z</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>2019-10-06T00:00:00.000Z</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>2019-10-07T00:00:00.000Z</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>2019-10-08T00:00:00.000Z</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'dateextract'</span><span class="p">,</span>
    <span class="nx">column</span><span class="p">:</span> <span class="s1">'Date'</span><span class="p">,</span>
    <span class="nx">operation</span><span class="p">:</span> <span class="s1">'day'</span><span class="p">,</span>
    <span class="nx">new_column_name</span><span class="p">:</span> <span class="s1">'Date_day'</span><span class="p">,</span>
    <span class="nx">format</span><span class="p">:</span> <span class="s1">'%Y-%m-%d'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Date</th>
      <th>Date_day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>2019-10-06T00:00:00.000Z</td>
      <td>6</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>2019-10-07T00:00:00.000Z</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>2019-10-08T00:00:00.000Z</td>
      <td>8</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>2019-10-06T00:00:00.000Z</td>
      <td>6</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>2019-10-07T00:00:00.000Z</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>2019-10-08T00:00:00.000Z</td>
      <td>8</td>
    </tr>
  </tbody>
</table>

<h3 id="delete-step"><code class="highlighter-rouge">delete</code> step</h3>

<p>Delete a column.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'delete'</span><span class="p">,</span>
    <span class="nx">columns</span><span class="p">:</span> <span class="p">[</span><span class="s1">'my-column'</span><span class="p">,</span> <span class="s1">'some-other-column'</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-5">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Group</th>
      <th>Value</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>Group 1</td>
      <td>13</td>
      <td>Company 1 - Group 1</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>Group 1</td>
      <td>7</td>
      <td>Company 2 - Group 1</td>
    </tr>
    <tr>
      <td>Company 3</td>
      <td>Group 1</td>
      <td>20</td>
      <td>Company 3 - Group 1</td>
    </tr>
    <tr>
      <td>Company 4</td>
      <td>Group 2</td>
      <td>1</td>
      <td>Company 4 - Group 2</td>
    </tr>
    <tr>
      <td>Company 5</td>
      <td>Group 2</td>
      <td>10</td>
      <td>Company 5 - Group 2</td>
    </tr>
    <tr>
      <td>Company 6</td>
      <td>Group 2</td>
      <td>5</td>
      <td>Company 6 - Group 2</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'delete'</span><span class="p">,</span>
  <span class="nx">columns</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Company'</span><span class="p">,</span> <span class="s1">'Group'</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Value</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>13</td>
      <td>Company 1 - Group 1</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Company 2 - Group 1</td>
    </tr>
    <tr>
      <td>20</td>
      <td>Company 3 - Group 1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Company 4 - Group 2</td>
    </tr>
    <tr>
      <td>10</td>
      <td>Company 5 - Group 2</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Company 6 - Group 2</td>
    </tr>
  </tbody>
</table>

<h3 id="domain-step"><code class="highlighter-rouge">domain</code> step</h3>

<p>This step is meant to select a specific domain (using MongoDB terminology).</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'domain'</span><span class="p">,</span>
    <span class="nx">domain</span><span class="p">:</span> <span class="s1">'my-domain'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h3 id="duplicate-step"><code class="highlighter-rouge">duplicate</code> step</h3>

<p>This step is meant to duplicate a column.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'duplicate'</span><span class="p">,</span>
    <span class="nx">column</span><span class="p">:</span> <span class="s1">'my-column'</span>
    <span class="nx">new_column_name</span><span class="p">:</span> <span class="s1">'my-duplicate'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-6">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>0</td>
    </tr>
    <tr>
      <td>Company 3</td>
      <td>20</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'duplicate'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s2">"Company"</span><span class="p">,</span>
  <span class="nx">new_column_name</span><span class="p">:</span> <span class="s2">"Company-copy"</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Value</th>
      <th>Company-copy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>13</td>
      <td>Company 1</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>0</td>
      <td>Company 2</td>
    </tr>
    <tr>
      <td>Company 3</td>
      <td>20</td>
      <td>Company 3</td>
    </tr>
  </tbody>
</table>

<h3 id="evolution-step"><code class="highlighter-rouge">evolution</code> step</h3>

<p>Use this step if you need to compute the row-by-row evolution of a value column,
based on a date column. It will output 2 columns: one for the evolution in
absolute value, the other for the evolution in percentage.</p>

<p>You must be careful that the computation is scoped so that there are no dates
duplicates (so that any date finds no more than one previous date). That means
that you may need to specify index columns to make any date unique by index. You
should use the <code class="highlighter-rouge">indexColumns</code> parameter to specifiy what series of columns
allows to build a unique index (by concatenation with the date column).
If index is not unique and more than one previous date is found, you will get
an error at row level (“Error: More than one previous date found for the
specified index columns”). Please refere to example 3 and 4 below for a concrete
illustration.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'evolution'</span><span class="p">,</span>
  <span class="nx">dateCol</span><span class="p">:</span> <span class="s1">'DATE'</span><span class="p">,</span>
  <span class="nx">valueCol</span><span class="p">:</span> <span class="s1">'VALUE'</span><span class="p">,</span>
  <span class="nx">evolutionType</span><span class="p">:</span> <span class="s1">'vsLastYear'</span><span class="p">,</span> <span class="c1">// or vsLastMonth, vsLastWeek, vsLastDay</span>
  <span class="nx">evolutionFormat</span><span class="p">:</span> <span class="s1">'abs'</span><span class="p">,</span> <span class="c1">// or pct</span>
  <span class="c1">// optional, if computation has to be performed by group so that any date finds no more than one previous date</span>
  <span class="nx">indexColumns</span><span class="p">:</span> <span class="p">[</span><span class="s1">'COUNTRY'</span><span class="p">],</span>
  <span class="nx">newColumn</span><span class="p">:</span> <span class="s1">'MY_EVOL'</span><span class="p">,</span> <span class="c1">// optional, &lt;originalColumnName&gt;_EVOL_ABS or &lt;originalColumnName&gt;_EVOL_PCT by default</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-1-basic-configuration---evolution-in-absolute-value">Example 1: Basic configuration - evolution in absolute value</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>DATE</th>
      <th>VALUE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2019-06</td>
      <td>79</td>
    </tr>
    <tr>
      <td>2019-07</td>
      <td>81</td>
    </tr>
    <tr>
      <td>2019-08</td>
      <td>77</td>
    </tr>
    <tr>
      <td>2019-09</td>
      <td>75</td>
    </tr>
    <tr>
      <td>2019-11</td>
      <td>78</td>
    </tr>
    <tr>
      <td>2019-12</td>
      <td>88</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'evolution'</span><span class="p">,</span>
  <span class="nx">dateCol</span><span class="p">:</span> <span class="s1">'DATE'</span><span class="p">,</span>
  <span class="nx">valueCol</span><span class="p">:</span> <span class="s1">'VALUE'</span><span class="p">,</span>
  <span class="nx">evolutionType</span><span class="p">:</span> <span class="s1">'vsLastMonth'</span><span class="p">,</span>
  <span class="nx">evolutionFormat</span><span class="p">:</span> <span class="s1">'abs'</span><span class="p">,</span>
  <span class="nx">indexColumns</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>DATE</th>
      <th>VALUE</th>
      <th>VALUE_EVOL_ABS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2019-06</td>
      <td>79</td>
      <td> </td>
    </tr>
    <tr>
      <td>2019-07</td>
      <td>81</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2019-08</td>
      <td>77</td>
      <td>-4</td>
    </tr>
    <tr>
      <td>2019-09</td>
      <td>75</td>
      <td>-2</td>
    </tr>
    <tr>
      <td>2019-11</td>
      <td>78</td>
      <td> </td>
    </tr>
    <tr>
      <td>2019-12</td>
      <td>88</td>
      <td>10</td>
    </tr>
  </tbody>
</table>

<h4 id="example-2-basic-configuration---evolution-in-percentage">Example 2: Basic configuration - evolution in percentage</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>DATE</th>
      <th>VALUE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2019-06</td>
      <td>79</td>
    </tr>
    <tr>
      <td>2019-07</td>
      <td>81</td>
    </tr>
    <tr>
      <td>2019-08</td>
      <td>77</td>
    </tr>
    <tr>
      <td>2019-09</td>
      <td>75</td>
    </tr>
    <tr>
      <td>2019-11</td>
      <td>78</td>
    </tr>
    <tr>
      <td>2019-12</td>
      <td>88</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'evolution'</span><span class="p">,</span>
  <span class="nx">dateCol</span><span class="p">:</span> <span class="s1">'DATE'</span><span class="p">,</span>
  <span class="nx">valueCol</span><span class="p">:</span> <span class="s1">'VALUE'</span><span class="p">,</span>
  <span class="nx">evolutionType</span><span class="p">:</span> <span class="s1">'vsLastMonth'</span><span class="p">,</span>
  <span class="nx">evolutionFormat</span><span class="p">:</span> <span class="s1">'pct'</span><span class="p">,</span>
  <span class="nx">indexColumns</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>DATE</th>
      <th>VALUE</th>
      <th>VALUE_EVOL_PCT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2019-06</td>
      <td>79</td>
      <td> </td>
    </tr>
    <tr>
      <td>2019-07</td>
      <td>81</td>
      <td>0.02531645569620253</td>
    </tr>
    <tr>
      <td>2019-08</td>
      <td>77</td>
      <td>-0.04938271604938271</td>
    </tr>
    <tr>
      <td>2019-09</td>
      <td>75</td>
      <td>-0.025974025974025976</td>
    </tr>
    <tr>
      <td>2019-11</td>
      <td>78</td>
      <td> </td>
    </tr>
    <tr>
      <td>2019-12</td>
      <td>88</td>
      <td>0.1282051282051282</td>
    </tr>
  </tbody>
</table>

<h4 id="example-3-error-on-duplicate-dates">Example 3: Error on duplicate dates</h4>

<p>If ‘COUNTRY’ is not specified as index column, the computation will not be
scoped by country. Then there are duplicate dates in the “DATE” columns which is
prohibited.</p>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>DATE</th>
      <th>COUNTRY</th>
      <th>VALUE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2014-12</td>
      <td>France</td>
      <td>79</td>
    </tr>
    <tr>
      <td>2015-12</td>
      <td>France</td>
      <td>81</td>
    </tr>
    <tr>
      <td>2016-12</td>
      <td>France</td>
      <td>77</td>
    </tr>
    <tr>
      <td>2017-12</td>
      <td>France</td>
      <td>75</td>
    </tr>
    <tr>
      <td>2014-12</td>
      <td>USA</td>
      <td>74</td>
    </tr>
    <tr>
      <td>2015-12</td>
      <td>USA</td>
      <td>74</td>
    </tr>
    <tr>
      <td>2016-12</td>
      <td>USA</td>
      <td>73</td>
    </tr>
    <tr>
      <td>2017-12</td>
      <td>USA</td>
      <td>72</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'evolution'</span><span class="p">,</span>
  <span class="nx">dateCol</span><span class="p">:</span> <span class="s1">'DATE'</span><span class="p">,</span>
  <span class="nx">valueCol</span><span class="p">:</span> <span class="s1">'VALUE'</span><span class="p">,</span>
  <span class="nx">evolutionType</span><span class="p">:</span> <span class="s1">'vsLastYear'</span><span class="p">,</span>
  <span class="nx">evolutionFormat</span><span class="p">:</span> <span class="s1">'abs'</span><span class="p">,</span>
  <span class="nx">indexColumns</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>DATE</th>
      <th>COUNTRY</th>
      <th>VALUE</th>
      <th>MY_EVOL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2014-12</td>
      <td>France</td>
      <td>79</td>
      <td> </td>
    </tr>
    <tr>
      <td>2015-12</td>
      <td>France</td>
      <td>81</td>
      <td>Error …</td>
    </tr>
    <tr>
      <td>2016-12</td>
      <td>France</td>
      <td>77</td>
      <td>Error …</td>
    </tr>
    <tr>
      <td>2017-12</td>
      <td>France</td>
      <td>75</td>
      <td>Error …</td>
    </tr>
    <tr>
      <td>2014-12</td>
      <td>USA</td>
      <td>74</td>
      <td> </td>
    </tr>
    <tr>
      <td>2015-12</td>
      <td>USA</td>
      <td>74</td>
      <td>Error …</td>
    </tr>
    <tr>
      <td>2016-12</td>
      <td>USA</td>
      <td>73</td>
      <td>Error …</td>
    </tr>
    <tr>
      <td>2017-12</td>
      <td>USA</td>
      <td>72</td>
      <td>Error …</td>
    </tr>
  </tbody>
</table>

<h4 id="example-4-complete-configuration-with-index-columns">Example 4: Complete configuration with index columns</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>DATE</th>
      <th>COUNTRY</th>
      <th>VALUE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2014-12</td>
      <td>France</td>
      <td>79</td>
    </tr>
    <tr>
      <td>2015-12</td>
      <td>France</td>
      <td>81</td>
    </tr>
    <tr>
      <td>2016-12</td>
      <td>France</td>
      <td>77</td>
    </tr>
    <tr>
      <td>2017-12</td>
      <td>France</td>
      <td>75</td>
    </tr>
    <tr>
      <td>2019-12</td>
      <td>France</td>
      <td>78</td>
    </tr>
    <tr>
      <td>2020-12</td>
      <td>France</td>
      <td>88</td>
    </tr>
    <tr>
      <td>2014-12</td>
      <td>USA</td>
      <td>74</td>
    </tr>
    <tr>
      <td>2015-12</td>
      <td>USA</td>
      <td>74</td>
    </tr>
    <tr>
      <td>2016-12</td>
      <td>USA</td>
      <td>73</td>
    </tr>
    <tr>
      <td>2017-12</td>
      <td>USA</td>
      <td>72</td>
    </tr>
    <tr>
      <td>2018-11</td>
      <td>USA</td>
      <td>75</td>
    </tr>
    <tr>
      <td>2020-12</td>
      <td>USA</td>
      <td>76</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'evolution'</span><span class="p">,</span>
  <span class="nx">dateCol</span><span class="p">:</span> <span class="s1">'DATE'</span><span class="p">,</span>
  <span class="nx">valueCol</span><span class="p">:</span> <span class="s1">'VALUE'</span><span class="p">,</span>
  <span class="nx">evolutionType</span><span class="p">:</span> <span class="s1">'vsLastYear'</span><span class="p">,</span>
  <span class="nx">evolutionFormat</span><span class="p">:</span> <span class="s1">'abs'</span><span class="p">,</span>
  <span class="nx">indexColumns</span><span class="p">:</span> <span class="p">[</span><span class="s1">'COUNTRY'</span><span class="p">],</span>
  <span class="nx">newColumn</span><span class="p">:</span> <span class="s1">'MY_EVOL'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>DATE</th>
      <th>COUNTRY</th>
      <th>VALUE</th>
      <th>MY_EVOL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2014-12</td>
      <td>France</td>
      <td>79</td>
      <td> </td>
    </tr>
    <tr>
      <td>2015-12</td>
      <td>France</td>
      <td>81</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2016-12</td>
      <td>France</td>
      <td>77</td>
      <td>-4</td>
    </tr>
    <tr>
      <td>2017-12</td>
      <td>France</td>
      <td>75</td>
      <td>-2</td>
    </tr>
    <tr>
      <td>2019-12</td>
      <td>France</td>
      <td>78</td>
      <td> </td>
    </tr>
    <tr>
      <td>2020-12</td>
      <td>France</td>
      <td>88</td>
      <td>10</td>
    </tr>
    <tr>
      <td>2014-12</td>
      <td>USA</td>
      <td>74</td>
      <td> </td>
    </tr>
    <tr>
      <td>2015-12</td>
      <td>USA</td>
      <td>74</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2016-12</td>
      <td>USA</td>
      <td>73</td>
      <td>-1</td>
    </tr>
    <tr>
      <td>2017-12</td>
      <td>USA</td>
      <td>72</td>
      <td>-1</td>
    </tr>
    <tr>
      <td>2018-11</td>
      <td>USA</td>
      <td>75</td>
      <td>3</td>
    </tr>
    <tr>
      <td>2020-12</td>
      <td>USA</td>
      <td>76</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h3 id="fillna-step"><code class="highlighter-rouge">fillna</code> step</h3>

<p>Replace null values by a given value in a column.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'fillna'</span><span class="p">,</span>
    <span class="nx">column</span><span class="p">:</span> <span class="s2">"foo"</span><span class="p">,</span>
    <span class="nx">value</span><span class="p">:</span> <span class="s2">"bar"</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-7">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>Group 1</td>
      <td> </td>
    </tr>
    <tr>
      <td>Company 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Company 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Company 5</td>
      <td>Group 2</td>
      <td> </td>
    </tr>
    <tr>
      <td>Company 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'fillna'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s2">"Value"</span><span class="p">,</span>
  <span class="nx">value</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>Group 1</td>
      <td>0</td>
    </tr>
    <tr>
      <td>Company 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Company 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Company 5</td>
      <td>Group 2</td>
      <td>0</td>
    </tr>
    <tr>
      <td>Company 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<h3 id="filter-step"><code class="highlighter-rouge">filter</code> step</h3>

<p>Filter out lines that don’t match a filter definition.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'filter'</span><span class="p">,</span>
    <span class="nx">condition</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">column</span><span class="p">:</span> <span class="s1">'my-column'</span><span class="p">,</span>
      <span class="nx">value</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
      <span class="nx">operator</span><span class="p">:</span> <span class="s1">'ne'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">operator</code> is optional, and defaults to <code class="highlighter-rouge">eq</code>. Allowed operators are <code class="highlighter-rouge">eq</code>, <code class="highlighter-rouge">ne</code>,
<code class="highlighter-rouge">gt</code>, <code class="highlighter-rouge">ge</code>, <code class="highlighter-rouge">lt</code>, <code class="highlighter-rouge">le</code>, <code class="highlighter-rouge">in</code>, <code class="highlighter-rouge">nin</code>, <code class="highlighter-rouge">matches</code>, <code class="highlighter-rouge">notmatches</code> <code class="highlighter-rouge">isnull</code> or <code class="highlighter-rouge">notnull</code>.</p>

<p><code class="highlighter-rouge">value</code> can be an arbitrary value depending on the selected operator (e.g a list
when used with the <code class="highlighter-rouge">in</code> operator, or <code class="highlighter-rouge">null</code> when used with the <code class="highlighter-rouge">isnull</code>
operator).</p>

<p><code class="highlighter-rouge">matches</code> and <code class="highlighter-rouge">notmatches</code> operators are used to test value against a regular expression.</p>

<p>Conditions can be grouped and nested with logical operators <code class="highlighter-rouge">and</code> and <code class="highlighter-rouge">or</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'filter'</span><span class="p">,</span>
    <span class="nx">condition</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">and</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="na">column</span><span class="p">:</span> <span class="s1">'my-column'</span><span class="p">,</span>
          <span class="na">value</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
          <span class="na">operator</span><span class="p">:</span> <span class="s1">'gte'</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="na">column</span><span class="p">:</span> <span class="s1">'my-column'</span><span class="p">,</span>
          <span class="na">value</span><span class="p">:</span> <span class="mi">118</span><span class="p">,</span>
          <span class="na">operator</span><span class="p">:</span> <span class="s1">'lte'</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="na">or</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="na">column</span><span class="p">:</span> <span class="s1">'my-other-column'</span><span class="p">,</span>
              <span class="na">value</span><span class="p">:</span> <span class="s1">'blue'</span><span class="p">,</span>
              <span class="na">operator</span><span class="p">:</span> <span class="s1">'eq'</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="na">column</span><span class="p">:</span> <span class="s1">'my-other-column'</span><span class="p">,</span>
              <span class="na">value</span><span class="p">:</span> <span class="s1">'red'</span><span class="p">,</span>
              <span class="na">operator</span><span class="p">:</span> <span class="s1">'eq'</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h3 id="formula-step"><code class="highlighter-rouge">formula</code> step</h3>

<p>Add a computation based on a formula. Usually column names do not need to be
escaped, unless they include whitespaces, in such a case you need to use
brackets ‘[]’ (e.g. [myColumn]). Any characters string escaped with quotes
(simple or double) will be considered as a string.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'formula'</span><span class="p">,</span>
    <span class="nx">new_column</span><span class="p">:</span> <span class="s1">'result'</span><span class="p">,</span> <span class="c1">// if the column already exists, overwrites it</span>
    <span class="nx">formula</span><span class="p">:</span> <span class="s1">'(Value1 + Value2) / Value3 - Value4 * 2'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="example-1-basic-usage-1">Example 1: Basic usage</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value1</th>
      <th>Value2</th>
      <th>Value3</th>
      <th>Value4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>10</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>1</td>
      <td>13</td>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>5</td>
      <td>20</td>
      <td>5</td>
      <td>2</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'formula'</span><span class="p">,</span>
  <span class="nx">new_column</span><span class="p">:</span> <span class="s1">'Result'</span><span class="p">,</span>
  <span class="nx">formula</span><span class="p">:</span> <span class="s1">'(Value1 + Value2) / Value3 - Value4 * 2'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value1</th>
      <th>Value2</th>
      <th>Value3</th>
      <th>Value4</th>
      <th>Result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>10</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>1</td>
      <td>13</td>
      <td>7</td>
      <td>3</td>
      <td>-4</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>5</td>
      <td>20</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<h4 id="example-2-column-name-with-whitespaces">Example 2: Column name with whitespaces</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value1</th>
      <th>Value2</th>
      <th>Value3</th>
      <th>Value 4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>10</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>1</td>
      <td>13</td>
      <td>7</td>
      <td>3</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>5</td>
      <td>20</td>
      <td>5</td>
      <td>2</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'formula'</span><span class="p">,</span>
  <span class="nx">new_column</span><span class="p">:</span> <span class="s1">'Result'</span><span class="p">,</span>
  <span class="nx">formula</span><span class="p">:</span> <span class="s1">'(Value1 + Value2) / Value3 - [Value 4] * 2'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value1</th>
      <th>Value2</th>
      <th>Value3</th>
      <th>Value 4</th>
      <th>Result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>10</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>1</td>
      <td>13</td>
      <td>7</td>
      <td>3</td>
      <td>-4</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>5</td>
      <td>20</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<h3 id="ifthenelse-step"><code class="highlighter-rouge">ifthenelse</code> step</h3>

<p>Creates a new column, which values will depend on a condition expressed on
existing columns.</p>

<p>The condition is expressed in the <code class="highlighter-rouge">if</code> parameter with a condition object, which
is the same object expected by the <code class="highlighter-rouge">condition</code> parameter of the
<a href="#filter-step">filter step</a>). Conditions can be grouped and nested with logical
operators <code class="highlighter-rouge">and</code> and <code class="highlighter-rouge">or</code>.</p>

<p>The <code class="highlighter-rouge">then</code> parameter only supports a string, that will be interpreted as a
formula (cf. <a href="#formula-step">formula step</a>). If you want it to be interpreted
striclty as a string and not a formula, you must escape the string with quotes
(e.g. ‘“this is a text”’).</p>

<p><code class="highlighter-rouge">if...then...else</code> blocks can be nested as the <code class="highlighter-rouge">else</code> parameter
supports either a string that will be interpreted as a formula (cf.
<a href="#formula-step">formula step</a>), or a nested if <code class="highlighter-rouge">if...then...else</code> object.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'ifthenelse'</span><span class="p">,</span>
  <span class="nx">newColumn</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// the name of the new column to be created</span>
  <span class="k">if</span><span class="p">:</span> <span class="p">{</span> <span class="nl">column</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="nx">operator</span><span class="p">:</span> <span class="s1">'eq'</span> <span class="p">},</span> <span class="c1">// a condition, same object as in the filter step</span>
  <span class="nx">then</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// a string that will be interpreted as a formula</span>
  <span class="k">else</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span> <span class="c1">// a string interpreted as a formula or a nested if...then...else object</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-8">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>-2</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>2</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>0</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'ifthenelse'</span><span class="p">,</span>
    <span class="nx">newColumn</span><span class="p">:</span> <span class="s1">'result'</span><span class="p">,</span>
    <span class="k">if</span><span class="p">:</span> <span class="p">{</span> <span class="nl">column</span><span class="p">:</span> <span class="s1">'number'</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">operator</span><span class="p">:</span> <span class="s1">'eq'</span> <span class="p">},</span>
    <span class="nx">then</span><span class="p">:</span> <span class="s1">'"zero"'</span>
    <span class="k">else</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">if</span><span class="p">:</span> <span class="p">{</span> <span class="nl">column</span><span class="p">:</span> <span class="s1">'rel'</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">operator</span><span class="p">:</span> <span class="s1">'lt'</span> <span class="p">},</span>
      <span class="nx">then</span><span class="p">:</span> <span class="s1">'number * -1'</span><span class="p">,</span>
      <span class="k">else</span><span class="p">:</span> <span class="s1">'number'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>number</th>
      <th>result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>-2</td>
      <td>2</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>0</td>
      <td>zero</td>
    </tr>
  </tbody>
</table>

<h3 id="join-step"><code class="highlighter-rouge">join</code> step</h3>

<p>Joins a dataset to the current dataset, i.e. brings columns from the former into
the latter, and matches rows based <code class="highlighter-rouge">on</code> columns correspondance. It is similar to
a <code class="highlighter-rouge">JOIN</code> clause in SQL, or to a <code class="highlighter-rouge">VLOOKUP</code> in excel. The joined dataset is the
result from the query of the <code class="highlighter-rouge">right_pipeline</code>.</p>

<p>The join type can be:</p>

<ul>
  <li>
    <p>‘left’: will keep every row of the current dataset and fill unmatched rows
with <code class="highlighter-rouge">null</code> values,</p>
  </li>
  <li>
    <p>‘inner’: will only keep rows that match rows of the joined dataset.</p>
  </li>
</ul>

<p>In the <code class="highlighter-rouge">on</code> parameter, you must specify 1 or more column couple(s) that will be
compared to determine rows correspondance between the 2 datasets. The first
element of a couple is for the current dataset column, and the second for the
corresponding column in the right dataset to be joined. If you specify more than
1 couple, the matching rows will be those that find a correspondance between the
2 datasets for every column couple specified (logical ‘AND’).</p>

<p>Weaverbird allows you to save <code class="highlighter-rouge">pipelines</code> referenced by name in the Vuex store
of the application. You can then call them by their unique names in this step.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'join'</span><span class="p">,</span>
  <span class="nx">right_pipeline</span><span class="p">:</span> <span class="s1">'somePipelineReference'</span><span class="p">,</span>
  <span class="nx">type</span><span class="p">:</span> <span class="s1">'left'</span><span class="p">,</span> <span class="c1">// or 'inner'</span>
  <span class="nx">on</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">'currentDatasetColumn1'</span><span class="p">,</span> <span class="s1">'rightDatasetColumn1'</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">'currentDatasetColumn2'</span><span class="p">,</span> <span class="s1">'rightDatasetColumn2'</span><span class="p">],</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-1-left-join-with-one-column-couple-as-on-parameter">Example 1: Left join with one column couple as <code class="highlighter-rouge">on</code> parameter</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p><strong>rightDataset (saved in the application Vuex store)</strong>:</p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 2</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'join'</span><span class="p">,</span>
  <span class="nx">right_pipeline</span><span class="p">:</span> <span class="s1">'rightDataset'</span><span class="p">,</span>
  <span class="nx">type</span><span class="p">:</span> <span class="s1">'left'</span><span class="p">,</span>
  <span class="nx">on</span><span class="p">:</span> <span class="p">[[</span><span class="s1">'Label'</span><span class="p">,</span> <span class="s1">'Label'</span><span class="p">]];</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
      <th>Group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>13</td>
      <td>Group 1</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>7</td>
      <td>Group 1</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>20</td>
      <td>Group 2</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>1</td>
      <td>Group 2</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>1</td>
      <td> </td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>1</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h4 id="example-2-inner-join-with-different-column-names-in-the-on-parameter">Example 2: inner join with different column names in the <code class="highlighter-rouge">on</code> parameter</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p><strong>rightDataset (saved in the application Vuex store)</strong>:</p>

<table>
  <thead>
    <tr>
      <th>LabelRight</th>
      <th>Group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 2</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'join'</span><span class="p">,</span>
  <span class="nx">right_pipeline</span><span class="p">:</span> <span class="s1">'rightDataset'</span><span class="p">,</span>
  <span class="nx">type</span><span class="p">:</span> <span class="s1">'inner'</span><span class="p">,</span>
  <span class="nx">on</span><span class="p">:</span> <span class="p">[[</span><span class="s1">'Label'</span><span class="p">,</span> <span class="s1">'LabelRight'</span><span class="p">]];</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
      <th>LabelRight</th>
      <th>Group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>13</td>
      <td>Label 1</td>
      <td>Group 1</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>7</td>
      <td>Label 2</td>
      <td>Group 1</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>20</td>
      <td>Label 3</td>
      <td>Group 2</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>1</td>
      <td>Label 4</td>
      <td>Group 2</td>
    </tr>
  </tbody>
</table>

<h3 id="fromdate-step"><code class="highlighter-rouge">fromdate</code> step</h3>

<p>Converts a date <code class="highlighter-rouge">column</code> into a string column based on a specified <code class="highlighter-rouge">format</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'fromdate'</span><span class="p">,</span>
    <span class="nx">column</span><span class="p">:</span> <span class="s1">'myDateColumn'</span>
    <span class="nx">format</span><span class="p">:</span> <span class="s1">'%Y-%m-%d'</span> <span class="c1">// For further details on supported format specifiers,</span>
                       <span class="c1">// see https://docs.mongodb.com/manual/reference/operator/aggregation/dateFromString/#datefromstring-format-specifiers</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-9">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Date</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>2019-10-06T00:00:00.000Z</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>2019-10-07T00:00:00.000Z</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>2019-10-08T00:00:00.000Z</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>2019-10-06T00:00:00.000Z</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>2019-10-07T00:00:00.000Z</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>2019-10-08T00:00:00.000Z</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'fromdate'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Date'</span><span class="p">,</span>
  <span class="nx">format</span><span class="p">:</span> <span class="s1">'%d/%m/%Y'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Date</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>06/10/2019</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>07/10/2019</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>08/10/2019</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>06/10/2019</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>07/10/2019</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>08/10/2019</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<h3 id="lowercase-step"><code class="highlighter-rouge">lowercase</code> step</h3>

<p>Converts a string <code class="highlighter-rouge">column</code> to lowercase.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'lowercase'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'foo'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-10">Example:</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>LABEL 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>LABEL 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>LABEL 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'lowercase'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Label'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
  </tbody>
</table>

<h3 id="percentage-step"><code class="highlighter-rouge">percentage</code> step</h3>

<p>Compute the percentage of total, i.e. for every row the value in <code class="highlighter-rouge">column</code> divided
by the total as the sum of every values in <code class="highlighter-rouge">column</code>. The computation can be performed
by <code class="highlighter-rouge">group</code> if specified. The result is written in a new column.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'percentage'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'bar'</span><span class="p">,</span>
  <span class="nx">group</span><span class="p">:</span> <span class="p">[</span><span class="s1">'foo'</span><span class="p">]</span> <span class="c1">// optional</span>
  <span class="nx">newColumName</span><span class="p">:</span> <span class="s1">'myNewColumn'</span> <span class="c1">// optional, &lt;originalColumname&gt;_PCT by default</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-11">Example:</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>15</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>2</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  <span class="nx">name</span><span class="p">:</span> <span class="s1">'percentage'</span><span class="p">,</span>
  <span class="nx">new_column</span><span class="p">:</span> <span class="s1">'Percentage_of_total'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Value'</span><span class="p">,</span>
  <span class="nx">group</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Group'</span><span class="p">]</span>
  <span class="nx">newColumn</span><span class="p">:</span> <span class="s1">'Percentage'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
      <th>Percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>5</td>
      <td>0.167</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>10</td>
      <td>0.333</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>15</td>
      <td>0.5</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>2</td>
      <td>0.143</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>7</td>
      <td>0.5</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
      <td>0.357</td>
    </tr>
  </tbody>
</table>

<h3 id="pivot-step"><code class="highlighter-rouge">pivot</code> step</h3>

<p>Pivot rows into columns around a given <code class="highlighter-rouge">index</code> (expressed as a combination of column(s)).
Values to be used as new column names are found in the column <code class="highlighter-rouge">column_to_pivot</code>.
Values to populate new columns are found in the column <code class="highlighter-rouge">value_column</code>.
The function used to aggregate data (when several rows are found by index group) must be
among <code class="highlighter-rouge">sum</code>, <code class="highlighter-rouge">avg</code>, <code class="highlighter-rouge">count</code>, <code class="highlighter-rouge">min</code> or <code class="highlighter-rouge">max</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
 <span class="nl">name</span><span class="p">:</span> <span class="s1">'pivot'</span><span class="p">,</span>
 <span class="nx">index</span><span class="p">:</span> <span class="p">[</span><span class="s1">'column_1'</span><span class="p">,</span> <span class="s1">'column_2'</span><span class="p">],</span>
 <span class="nx">column_to_pivot</span><span class="p">:</span> <span class="s1">'column_3'</span><span class="p">,</span>
 <span class="nx">value_column</span><span class="p">:</span> <span class="s1">'column_4'</span><span class="p">,</span>
 <span class="nx">agg_function</span><span class="p">:</span> <span class="s1">'sum'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-12">Example:</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Country</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Country1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Country1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Country1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 1</td>
      <td>Country2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Country2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Country2</td>
      <td>5</td>
    </tr>
    <tr>
      <td>label 3</td>
      <td>Country2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
 <span class="nl">name</span><span class="p">:</span> <span class="s1">'pivot'</span><span class="p">,</span>
 <span class="nx">index</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Label'</span><span class="p">],</span>
 <span class="nx">column_to_pivot</span><span class="p">:</span> <span class="s1">'Country'</span><span class="p">,</span>
 <span class="nx">value_column</span><span class="p">:</span> <span class="s1">'Value'</span><span class="p">,</span>
 <span class="nx">agg_function</span><span class="p">:</span> <span class="s1">'sum'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Country1</th>
      <th>Country2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>13</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>20</td>
      <td>6</td>
    </tr>
  </tbody>
</table>

<h3 id="statistics-step"><code class="highlighter-rouge">statistics</code> step</h3>

<p>Compute statistics of a column.,</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'statistics'</span><span class="p">,</span>
    <span class="nx">column</span><span class="p">:</span> <span class="s1">'Value'</span><span class="p">,</span>
    <span class="nx">groupby</span><span class="p">:</span> <span class="p">[],</span>
    <span class="nx">statistics</span><span class="p">:</span> <span class="p">[</span><span class="s1">'average'</span><span class="p">,</span> <span class="s1">'count'</span><span class="p">],</span>
    <span class="nx">quantiles</span><span class="p">:</span> <span class="p">[{</span><span class="na">label</span><span class="p">:</span> <span class="s1">'median'</span><span class="p">,</span> <span class="na">nth</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">order</span><span class="p">:</span> <span class="mi">2</span><span class="p">}],</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-13">Example:</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'statistics'</span><span class="p">,</span>
    <span class="nx">column</span><span class="p">:</span> <span class="s1">'Value'</span><span class="p">,</span>
    <span class="nx">groupby</span><span class="p">:</span> <span class="p">[],</span>
    <span class="nx">statistics</span><span class="p">:</span> <span class="p">[</span><span class="s1">'average'</span><span class="p">,</span> <span class="s1">'count'</span><span class="p">],</span>
    <span class="nx">quantiles</span><span class="p">:</span> <span class="p">[{</span><span class="na">label</span><span class="p">:</span> <span class="s1">'median'</span><span class="p">,</span> <span class="na">nth</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">order</span><span class="p">:</span> <span class="mi">2</span><span class="p">}],</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>average</th>
      <th>count</th>
      <th>median</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>9.33333</td>
      <td>6</td>
      <td>8.5</td>
    </tr>
  </tbody>
</table>

<h3 id="rename-step"><code class="highlighter-rouge">rename</code> step</h3>

<p>Rename a column.,</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'rename'</span><span class="p">,</span>
    <span class="nx">oldname</span><span class="p">:</span> <span class="s1">'old-column-name'</span><span class="p">,</span>
    <span class="nx">newname</span><span class="p">:</span> <span class="s1">'new-column-name'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-14">Example:</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'rename'</span><span class="p">,</span>
  <span class="nx">oldname</span><span class="p">:</span> <span class="s1">'Label'</span><span class="p">,</span>
  <span class="nx">newname</span><span class="p">:</span> <span class="s1">'Company'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<h3 id="replace-step"><code class="highlighter-rouge">replace</code> step</h3>

<p>Replace one or several values in a column.</p>

<p>A replace step has the following strucure:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
   <span class="nl">name</span><span class="p">:</span> <span class="s1">'replace'</span><span class="p">,</span>
   <span class="nx">search_column</span><span class="p">:</span> <span class="s2">"column_1"</span><span class="p">,</span>
   <span class="nx">to_replace</span><span class="p">:</span> <span class="p">[</span>
     <span class="p">[</span><span class="s1">'foo'</span><span class="p">,</span> <span class="s1">'bar'</span><span class="p">],</span> <span class="c1">// The first value is the one to be replace, the second is the new value</span>
     <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
   <span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-15">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>COMPANY</th>
      <th>COUNTRY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>Fr</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>UK</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
   <span class="nl">name</span><span class="p">:</span> <span class="s1">'replace'</span><span class="p">,</span>
   <span class="nx">search_column</span><span class="p">:</span> <span class="s2">"COUNTRY"</span><span class="p">,</span>
   <span class="nx">to_replace</span><span class="p">:</span> <span class="p">[</span>
     <span class="p">[</span><span class="s1">'Fr'</span><span class="p">,</span> <span class="s1">'France'</span><span class="p">]</span>
     <span class="p">[</span><span class="s1">'UK'</span><span class="p">,</span> <span class="s1">'United Kingdom'</span><span class="p">]</span>
   <span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>COMPANY</th>
      <th>COUNTRY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>France</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>

<h3 id="rollup-step"><code class="highlighter-rouge">rollup</code> step</h3>

<p>Use this step if you need to compute aggregated data at every level of a
<code class="highlighter-rouge">hierarchy</code>, specified as a series of columns from top to bottom level.
The output data structure stacks the data of every level of the hierarchy,
specifying for every row the label, level and parent in dedicated columns.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
   <span class="nl">name</span><span class="p">:</span> <span class="s1">'rollup'</span><span class="p">,</span>
   <span class="nx">hierarchy</span><span class="p">:</span> <span class="p">[</span><span class="s1">'continent'</span><span class="p">,</span> <span class="s1">'country'</span><span class="p">,</span> <span class="s1">'city'</span><span class="p">],</span> <span class="c1">// Hierarchical columns, from top to bottom level</span>
   <span class="nx">aggregations</span><span class="p">:</span> <span class="p">[</span> <span class="c1">// The columns to be aggregated, and how</span>
    <span class="p">{</span>
      <span class="na">newcolumn</span><span class="p">:</span> <span class="s1">'revenues'</span><span class="p">,</span>
      <span class="na">aggfunction</span><span class="p">:</span> <span class="s1">'sum'</span><span class="p">,</span> <span class="c1">// aggregate using sum</span>
      <span class="na">column</span><span class="p">:</span> <span class="s1">'revenues'</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">newcolumn</span><span class="p">:</span> <span class="s1">'average_cost'</span><span class="p">,</span>
      <span class="na">aggfunction</span><span class="p">:</span> <span class="s1">'avg'</span><span class="p">,</span> <span class="c1">// aggregate using average</span>
      <span class="na">column</span><span class="p">:</span> <span class="s1">'cost'</span>
    <span class="p">}</span>
   <span class="p">],</span>
   <span class="nx">groupby</span><span class="p">:</span> <span class="p">[</span><span class="s1">'date'</span><span class="p">],</span> <span class="c1">// optional, if needing to segment the rollup computation by group</span>
   <span class="nx">labelCol</span><span class="p">:</span> <span class="s1">'label'</span><span class="p">,</span> <span class="c1">// optional, name of the output label column, 'label' by default</span>
   <span class="nx">levelCol</span><span class="p">:</span> <span class="s1">'label'</span><span class="p">,</span> <span class="c1">// optional, name of the output level column, 'level' by default</span>
   <span class="nx">parentLabelCol</span><span class="p">:</span> <span class="s1">'label'</span><span class="p">,</span> <span class="c1">// optional, name of the output parent column, 'parent' by default</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-1--basic-configuration">Example 1 : Basic configuration</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>CITY</th>
      <th>COUNTRY</th>
      <th>CONTINENT</th>
      <th>YEAR</th>
      <th>VALUE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Paris</td>
      <td>France</td>
      <td>Europe</td>
      <td>2018</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Bordeaux</td>
      <td>France</td>
      <td>Europe</td>
      <td>2018</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Barcelona</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2018</td>
      <td>8</td>
    </tr>
    <tr>
      <td>Madrid</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2018</td>
      <td>3</td>
    </tr>
    <tr>
      <td>Boston</td>
      <td>USA</td>
      <td>North America</td>
      <td>2018</td>
      <td>12</td>
    </tr>
    <tr>
      <td>New-York</td>
      <td>USA</td>
      <td>North America</td>
      <td>2018</td>
      <td>21</td>
    </tr>
    <tr>
      <td>Montreal</td>
      <td>Canada</td>
      <td>North America</td>
      <td>2018</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Ottawa</td>
      <td>Canada</td>
      <td>North America</td>
      <td>2018</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Paris</td>
      <td>France</td>
      <td>Europe</td>
      <td>2019</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Bordeaux</td>
      <td>France</td>
      <td>Europe</td>
      <td>2019</td>
      <td>8</td>
    </tr>
    <tr>
      <td>Barcelona</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2019</td>
      <td>11</td>
    </tr>
    <tr>
      <td>Madrid</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2019</td>
      <td>6</td>
    </tr>
    <tr>
      <td>Boston</td>
      <td>USA</td>
      <td>North America</td>
      <td>2019</td>
      <td>15</td>
    </tr>
    <tr>
      <td>New-York</td>
      <td>USA</td>
      <td>North America</td>
      <td>2019</td>
      <td>24</td>
    </tr>
    <tr>
      <td>Montreal</td>
      <td>Canada</td>
      <td>North America</td>
      <td>2019</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Ottawa</td>
      <td>Canada</td>
      <td>North America</td>
      <td>2019</td>
      <td>13</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
   <span class="nl">name</span><span class="p">:</span> <span class="s1">'rollup'</span><span class="p">,</span>
   <span class="nx">hierarchy</span><span class="p">:</span> <span class="p">[</span><span class="s1">'CONTINENT'</span><span class="p">,</span> <span class="s1">'COUNTRY'</span><span class="p">,</span> <span class="s1">'CITY'</span><span class="p">],</span>
   <span class="nx">aggregations</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">newcolumn</span><span class="p">:</span> <span class="s1">'revenues'</span><span class="p">,</span>
      <span class="na">aggfunction</span><span class="p">:</span> <span class="s1">'sum'</span><span class="p">,</span>
      <span class="na">column</span><span class="p">:</span> <span class="s1">'revenues'</span>
    <span class="p">},</span>
   <span class="p">],</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>CITY</th>
      <th>COUNTRY</th>
      <th>CONTINENT</th>
      <th>label</th>
      <th>level</th>
      <th>parent</th>
      <th>VALUE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td> </td>
      <td>North America</td>
      <td>Europe</td>
      <td>CONTINENT</td>
      <td> </td>
      <td>64</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td>North America</td>
      <td>North America</td>
      <td>CONTINENT</td>
      <td> </td>
      <td>112</td>
    </tr>
    <tr>
      <td> </td>
      <td>France</td>
      <td>Europe</td>
      <td>France</td>
      <td>COUNTRY</td>
      <td>Europe</td>
      <td>36</td>
    </tr>
    <tr>
      <td> </td>
      <td>Spain</td>
      <td>Europe</td>
      <td>Spain</td>
      <td>COUNTRY</td>
      <td>Europe</td>
      <td>28</td>
    </tr>
    <tr>
      <td> </td>
      <td>USA</td>
      <td>North America</td>
      <td>USA</td>
      <td>COUNTRY</td>
      <td>North America</td>
      <td>72</td>
    </tr>
    <tr>
      <td> </td>
      <td>Canada</td>
      <td>North America</td>
      <td>Canada</td>
      <td>COUNTRY</td>
      <td>North America</td>
      <td>40</td>
    </tr>
    <tr>
      <td>Paris</td>
      <td>France</td>
      <td>Europe</td>
      <td>Paris</td>
      <td>CITY</td>
      <td>France</td>
      <td>23</td>
    </tr>
    <tr>
      <td>Bordeaux</td>
      <td>France</td>
      <td>Europe</td>
      <td>Bordeaux</td>
      <td>CITY</td>
      <td>France</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Barcelona</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>Barcelona</td>
      <td>CITY</td>
      <td>Spain</td>
      <td>19</td>
    </tr>
    <tr>
      <td>Madrid</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>Madrid</td>
      <td>CITY</td>
      <td>Spain</td>
      <td>9</td>
    </tr>
    <tr>
      <td>Boston</td>
      <td>USA</td>
      <td>North America</td>
      <td>Boston</td>
      <td>CITY</td>
      <td>USA</td>
      <td>27</td>
    </tr>
    <tr>
      <td>New-York</td>
      <td>USA</td>
      <td>North America</td>
      <td>New-York</td>
      <td>CITY</td>
      <td>USA</td>
      <td>45</td>
    </tr>
    <tr>
      <td>Montreal</td>
      <td>Canada</td>
      <td>North America</td>
      <td>Montreal</td>
      <td>CITY</td>
      <td>Canada</td>
      <td>17</td>
    </tr>
    <tr>
      <td>Ottawa</td>
      <td>Canada</td>
      <td>North America</td>
      <td>Ottawa</td>
      <td>CITY</td>
      <td>Canada</td>
      <td>23</td>
    </tr>
  </tbody>
</table>

<h4 id="example-2--configuration-with-optional-parameters">Example 2 : Configuration with optional parameters</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>CITY</th>
      <th>COUNTRY</th>
      <th>CONTINENT</th>
      <th>YEAR</th>
      <th>VALUE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Paris</td>
      <td>France</td>
      <td>Europe</td>
      <td>2018</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Bordeaux</td>
      <td>France</td>
      <td>Europe</td>
      <td>2018</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Barcelona</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2018</td>
      <td>8</td>
    </tr>
    <tr>
      <td>Madrid</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2018</td>
      <td>3</td>
    </tr>
    <tr>
      <td>Boston</td>
      <td>USA</td>
      <td>North America</td>
      <td>2018</td>
      <td>12</td>
    </tr>
    <tr>
      <td>New-York</td>
      <td>USA</td>
      <td>North America</td>
      <td>2018</td>
      <td>21</td>
    </tr>
    <tr>
      <td>Montreal</td>
      <td>Canada</td>
      <td>North America</td>
      <td>2018</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Ottawa</td>
      <td>Canada</td>
      <td>North America</td>
      <td>2018</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Paris</td>
      <td>France</td>
      <td>Europe</td>
      <td>2019</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Bordeaux</td>
      <td>France</td>
      <td>Europe</td>
      <td>2019</td>
      <td>8</td>
    </tr>
    <tr>
      <td>Barcelona</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2019</td>
      <td>11</td>
    </tr>
    <tr>
      <td>Madrid</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2019</td>
      <td>6</td>
    </tr>
    <tr>
      <td>Boston</td>
      <td>USA</td>
      <td>North America</td>
      <td>2019</td>
      <td>15</td>
    </tr>
    <tr>
      <td>New-York</td>
      <td>USA</td>
      <td>North America</td>
      <td>2019</td>
      <td>24</td>
    </tr>
    <tr>
      <td>Montreal</td>
      <td>Canada</td>
      <td>North America</td>
      <td>2019</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Ottawa</td>
      <td>Canada</td>
      <td>North America</td>
      <td>2019</td>
      <td>13</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
   <span class="nl">name</span><span class="p">:</span> <span class="s1">'rollup'</span><span class="p">,</span>
   <span class="nx">hierarchy</span><span class="p">:</span> <span class="p">[</span><span class="s1">'CONTINENT'</span><span class="p">,</span> <span class="s1">'COUNTRY'</span><span class="p">,</span> <span class="s1">'CITY'</span><span class="p">],</span>
   <span class="nx">aggregations</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">newcolumn</span><span class="p">:</span> <span class="s1">'VALUE-sum'</span><span class="p">,</span>
      <span class="na">aggfunction</span><span class="p">:</span> <span class="s1">'sum'</span><span class="p">,</span>
      <span class="na">column</span><span class="p">:</span> <span class="s1">'VALUE'</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">newcolumn</span><span class="p">:</span> <span class="s1">'VALUE-avg'</span><span class="p">,</span>
      <span class="na">aggfunction</span><span class="p">:</span> <span class="s1">'avg'</span><span class="p">,</span>
      <span class="na">column</span><span class="p">:</span> <span class="s1">'VALUE'</span>
    <span class="p">}</span>
   <span class="p">],</span>
   <span class="nx">groupby</span><span class="p">:</span> <span class="p">[</span><span class="s1">'date'</span><span class="p">],</span>
   <span class="nx">labelCol</span><span class="p">:</span> <span class="s1">'label'</span><span class="p">,</span>
   <span class="nx">levelCol</span><span class="p">:</span> <span class="s1">'label'</span><span class="p">,</span>
   <span class="nx">parentLabelCol</span><span class="p">:</span> <span class="s1">'label'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>CITY</th>
      <th>COUNTRY</th>
      <th>CONTINENT</th>
      <th>YEAR</th>
      <th>MY_LABEL</th>
      <th>MY_LEVEL</th>
      <th>MY_PARENT</th>
      <th>VALUE-sum</th>
      <th>VALUE-avg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> </td>
      <td> </td>
      <td>North America</td>
      <td>2018</td>
      <td>Europe</td>
      <td>CONTINENT</td>
      <td> </td>
      <td>26</td>
      <td>6.5</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td>North America</td>
      <td>2018</td>
      <td>North America</td>
      <td>CONTINENT</td>
      <td> </td>
      <td>50</td>
      <td>12.5</td>
    </tr>
    <tr>
      <td> </td>
      <td>France</td>
      <td>Europe</td>
      <td>2018</td>
      <td>France</td>
      <td>COUNTRY</td>
      <td>Europe</td>
      <td>15</td>
      <td>7.5</td>
    </tr>
    <tr>
      <td> </td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2018</td>
      <td>Spain</td>
      <td>COUNTRY</td>
      <td>Europe</td>
      <td>11</td>
      <td>5.5</td>
    </tr>
    <tr>
      <td> </td>
      <td>USA</td>
      <td>North America</td>
      <td>2018</td>
      <td>USA</td>
      <td>COUNTRY</td>
      <td>North America</td>
      <td>33</td>
      <td>16.5</td>
    </tr>
    <tr>
      <td> </td>
      <td>Canada</td>
      <td>North America</td>
      <td>2018</td>
      <td>Canada</td>
      <td>COUNTRY</td>
      <td>North America</td>
      <td>17</td>
      <td>8.5</td>
    </tr>
    <tr>
      <td>Paris</td>
      <td>France</td>
      <td>Europe</td>
      <td>2018</td>
      <td>Paris</td>
      <td>CITY</td>
      <td>France</td>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Bordeaux</td>
      <td>France</td>
      <td>Europe</td>
      <td>2018</td>
      <td>Bordeaux</td>
      <td>CITY</td>
      <td>France</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Barcelona</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2018</td>
      <td>Barcelona</td>
      <td>CITY</td>
      <td>Spain</td>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <td>Madrid</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2018</td>
      <td>Madrid</td>
      <td>CITY</td>
      <td>Spain</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <td>Boston</td>
      <td>USA</td>
      <td>North America</td>
      <td>2018</td>
      <td>Boston</td>
      <td>CITY</td>
      <td>USA</td>
      <td>12</td>
      <td>12</td>
    </tr>
    <tr>
      <td>New-York</td>
      <td>USA</td>
      <td>North America</td>
      <td>2018</td>
      <td>New-York</td>
      <td>CITY</td>
      <td>USA</td>
      <td>21</td>
      <td>21</td>
    </tr>
    <tr>
      <td>Montreal</td>
      <td>Canada</td>
      <td>North America</td>
      <td>2018</td>
      <td>Montreal</td>
      <td>CITY</td>
      <td>Canada</td>
      <td>7</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Ottawa</td>
      <td>Canada</td>
      <td>North America</td>
      <td>2018</td>
      <td>Ottawa</td>
      <td>CITY</td>
      <td>Canada</td>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td>North America</td>
      <td>2019</td>
      <td>Europe</td>
      <td>CONTINENT</td>
      <td> </td>
      <td>38</td>
      <td>9.5</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
      <td>North America</td>
      <td>2019</td>
      <td>North America</td>
      <td>CONTINENT</td>
      <td> </td>
      <td>62</td>
      <td>15.5</td>
    </tr>
    <tr>
      <td> </td>
      <td>France</td>
      <td>Europe</td>
      <td>2019</td>
      <td>France</td>
      <td>COUNTRY</td>
      <td>Europe</td>
      <td>21</td>
      <td>10.5</td>
    </tr>
    <tr>
      <td> </td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2019</td>
      <td>Spain</td>
      <td>COUNTRY</td>
      <td>Europe</td>
      <td>17</td>
      <td>8.5</td>
    </tr>
    <tr>
      <td> </td>
      <td>USA</td>
      <td>North America</td>
      <td>2019</td>
      <td>USA</td>
      <td>COUNTRY</td>
      <td>North America</td>
      <td>39</td>
      <td>19.5</td>
    </tr>
    <tr>
      <td> </td>
      <td>Canada</td>
      <td>North America</td>
      <td>2019</td>
      <td>Canada</td>
      <td>COUNTRY</td>
      <td>North America</td>
      <td>23</td>
      <td>11.1</td>
    </tr>
    <tr>
      <td>Paris</td>
      <td>France</td>
      <td>Europe</td>
      <td>2019</td>
      <td>Paris</td>
      <td>CITY</td>
      <td>France</td>
      <td>13</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Bordeaux</td>
      <td>France</td>
      <td>Europe</td>
      <td>2019</td>
      <td>Bordeaux</td>
      <td>CITY</td>
      <td>France</td>
      <td>8</td>
      <td>8</td>
    </tr>
    <tr>
      <td>Barcelona</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2019</td>
      <td>Barcelona</td>
      <td>CITY</td>
      <td>Spain</td>
      <td>11</td>
      <td>11</td>
    </tr>
    <tr>
      <td>Madrid</td>
      <td>Spain</td>
      <td>Europe</td>
      <td>2019</td>
      <td>Madrid</td>
      <td>CITY</td>
      <td>Spain</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <td>Boston</td>
      <td>USA</td>
      <td>North America</td>
      <td>2019</td>
      <td>Boston</td>
      <td>CITY</td>
      <td>USA</td>
      <td>15</td>
      <td>15</td>
    </tr>
    <tr>
      <td>New-York</td>
      <td>USA</td>
      <td>North America</td>
      <td>2019</td>
      <td>New-York</td>
      <td>CITY</td>
      <td>USA</td>
      <td>24</td>
      <td>24</td>
    </tr>
    <tr>
      <td>Montreal</td>
      <td>Canada</td>
      <td>North America</td>
      <td>2019</td>
      <td>Montreal</td>
      <td>CITY</td>
      <td>Canada</td>
      <td>17</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Ottawa</td>
      <td>Canada</td>
      <td>North America</td>
      <td>2019</td>
      <td>Ottawa</td>
      <td>CITY</td>
      <td>Canada</td>
      <td>23</td>
      <td>13</td>
    </tr>
  </tbody>
</table>

<h3 id="select-step"><code class="highlighter-rouge">select</code> step</h3>

<p>Select a column. The default is to keep every columns of the input domain. If
the <code class="highlighter-rouge">select</code> is used, it will only keep selected columns in the output.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'select'</span><span class="p">,</span>
    <span class="nx">columns</span><span class="p">:</span> <span class="p">[</span><span class="s1">'my-column'</span><span class="p">,</span> <span class="s1">'some-other-column'</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-16">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Group</th>
      <th>Value</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>Group 1</td>
      <td>13</td>
      <td>Company 1 - Group 1</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>Group 1</td>
      <td>7</td>
      <td>Company 2 - Group 1</td>
    </tr>
    <tr>
      <td>Company 3</td>
      <td>Group 1</td>
      <td>20</td>
      <td>Company 3 - Group 1</td>
    </tr>
    <tr>
      <td>Company 4</td>
      <td>Group 2</td>
      <td>1</td>
      <td>Company 4 - Group 2</td>
    </tr>
    <tr>
      <td>Company 5</td>
      <td>Group 2</td>
      <td>10</td>
      <td>Company 5 - Group 2</td>
    </tr>
    <tr>
      <td>Company 6</td>
      <td>Group 2</td>
      <td>5</td>
      <td>Company 6 - Group 2</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'select'</span><span class="p">,</span>
    <span class="nx">columns</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Value'</span><span class="p">,</span> <span class="s1">'Label'</span><span class="p">]</span>
<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Value</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>13</td>
      <td>Company 1 - Group 1</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Company 2 - Group 1</td>
    </tr>
    <tr>
      <td>20</td>
      <td>Company 3 - Group 1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Company 4 - Group 2</td>
    </tr>
    <tr>
      <td>10</td>
      <td>Company 5 - Group 2</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Company 6 - Group 2</td>
    </tr>
  </tbody>
</table>

<h3 id="sort-step"><code class="highlighter-rouge">sort</code> step</h3>

<p>Sort values in one or several columns. Order can be either ‘asc’ or ‘desc’.
When sorting on several columns, order of columns specified in <code class="highlighter-rouge">columns</code> matters.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'sort'</span><span class="p">,</span>
    <span class="nx">columns</span><span class="p">:</span> <span class="p">[{</span><span class="na">column</span><span class="p">:</span> <span class="s1">'foo'</span><span class="p">,</span> <span class="na">order</span><span class="p">:</span> <span class="s1">'asc'</span><span class="p">},</span> <span class="p">{</span><span class="na">column</span><span class="p">:</span> <span class="s1">'bar'</span><span class="p">,</span> <span class="na">order</span><span class="p">:</span> <span class="s1">'desc'</span><span class="p">}],</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-17">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'sort'</span><span class="p">,</span>
    <span class="nx">columns</span><span class="p">:</span> <span class="p">[{</span> <span class="na">column</span><span class="p">:</span> <span class="s1">'Group'</span><span class="p">,</span> <span class="na">order</span><span class="p">:</span> <span class="s1">'asc'</span><span class="p">},</span> <span class="p">{</span><span class="na">column</span><span class="p">:</span> <span class="s1">'Value'</span><span class="p">,</span> <span class="na">order</span><span class="p">:</span> <span class="s1">'desc'</span> <span class="p">}]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<h3 id="split-step"><code class="highlighter-rouge">split</code> step</h3>

<p>Split a string <code class="highlighter-rouge">column</code> into several columns based on a <code class="highlighter-rouge">delimiter</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'split'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'foo'</span><span class="p">,</span> <span class="c1">// the columnn to split</span>
  <span class="nx">delimiter</span><span class="p">:</span> <span class="s1">' - '</span><span class="p">,</span> <span class="c1">// the delimiter can e a strinng of any length</span>
  <span class="nx">number_cols_to_keep</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="c1">// the numer of columns to keep resulting from the</span>
                          <span class="c1">// split (starting from first chunk)</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-1">Example 1</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1 - Group 1 - France</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2 - Group 1 - Spain</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3 - Group 1 - USA</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4 - Group 2 - France</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5 - Group 2 - Spain</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6 - Group 2 - USA</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'split'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Label'</span><span class="p">,</span>
  <span class="nx">delimiter</span><span class="p">:</span> <span class="s1">' - '</span><span class="p">,</span>
  <span class="nx">number_cols_to_keep</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label_1</th>
      <th>Label_2</th>
      <th>Label_3</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>Spain</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>USA</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>France</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>USA</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>France</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>Spain</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<h4 id="example-2-keeping-less-columns">Example 2: keeping less columns</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1 - Group 1 - France</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2 - Group 1 - Spain</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3 - Group 1 - USA</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4 - Group 2 - France</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5 - Group 2 - Spain</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6 - Group 2 - USA</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'split'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Label'</span><span class="p">,</span>
  <span class="nx">delimiter</span><span class="p">:</span> <span class="s1">' - '</span><span class="p">,</span>
  <span class="nx">number_cols_to_keep</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label_1</th>
      <th>Label_2</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<h3 id="substring-step"><code class="highlighter-rouge">substring</code> step</h3>

<p>Extract a substring in a string <code class="highlighter-rouge">column</code>. The substring begins at index
<code class="highlighter-rouge">start_index</code> (beginning at <code class="highlighter-rouge">1</code>) and stops at <code class="highlighter-rouge">end_index</code>.
You can specify negative indexes, in such a case the index search will start
from the end of the string (with <code class="highlighter-rouge">-1</code> being the last index of the string).
Please refer to the examples below for illustration.
Neither <code class="highlighter-rouge">start_index</code> nor <code class="highlighter-rouge">end_index</code> can be equal to 0.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'substring'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'foo'</span><span class="p">,</span>
  <span class="nx">start_index</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// 1 = fisrt character</span>
  <span class="nx">end_index</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="c1">// -1 = last character</span>
  <span class="nx">newColumName</span><span class="p">:</span> <span class="s1">'myNewColumn'</span> <span class="c1">// optional, &lt;originalColumame&gt;_SUBSTR by default</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-1-positive-start_index-and-end_index">Example 1: positive <code class="highlighter-rouge">start_index</code> and <code class="highlighter-rouge">end_index</code></h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>foo</td>
      <td>13</td>
    </tr>
    <tr>
      <td>overflow</td>
      <td>7</td>
    </tr>
    <tr>
      <td>some_text</td>
      <td>20</td>
    </tr>
    <tr>
      <td>a_word</td>
      <td>1</td>
    </tr>
    <tr>
      <td>toucan</td>
      <td>10</td>
    </tr>
    <tr>
      <td>toco</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">column</span><span class="p">:</span> <span class="s1">'Label'</span><span class="p">,</span>
  <span class="nx">name</span><span class="p">:</span> <span class="s1">'substring'</span><span class="p">,</span>
  <span class="nx">start_index</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="nx">end_index</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
      <th>Label_PCT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>foo</td>
      <td>13</td>
      <td>foo</td>
    </tr>
    <tr>
      <td>overflow</td>
      <td>7</td>
      <td>over</td>
    </tr>
    <tr>
      <td>some_text</td>
      <td>20</td>
      <td>some</td>
    </tr>
    <tr>
      <td>a_word</td>
      <td>1</td>
      <td>a_wo</td>
    </tr>
    <tr>
      <td>toucan</td>
      <td>10</td>
      <td>touc</td>
    </tr>
    <tr>
      <td>toco</td>
      <td>5</td>
      <td>toco</td>
    </tr>
  </tbody>
</table>

<h4 id="example-2-start_index-is-positive-and-end_index-is-negative">Example 2: <code class="highlighter-rouge">start_index</code> is positive and <code class="highlighter-rouge">end_index</code> is negative</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>foo</td>
      <td>13</td>
    </tr>
    <tr>
      <td>overflow</td>
      <td>7</td>
    </tr>
    <tr>
      <td>some_text</td>
      <td>20</td>
    </tr>
    <tr>
      <td>a_word</td>
      <td>1</td>
    </tr>
    <tr>
      <td>toucan</td>
      <td>10</td>
    </tr>
    <tr>
      <td>toco</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'substring'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Label'</span><span class="p">,</span>
  <span class="nx">start_index</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="nx">end_index</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
  <span class="nx">newColumName</span><span class="p">:</span> <span class="s1">'short_label'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
      <th>short_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>foo</td>
      <td>13</td>
      <td>o</td>
    </tr>
    <tr>
      <td>overflow</td>
      <td>7</td>
      <td>verflo</td>
    </tr>
    <tr>
      <td>some_text</td>
      <td>20</td>
      <td>ome_tex</td>
    </tr>
    <tr>
      <td>a_word</td>
      <td>1</td>
      <td>_wor</td>
    </tr>
    <tr>
      <td>toucan</td>
      <td>10</td>
      <td>ouca</td>
    </tr>
    <tr>
      <td>toco</td>
      <td>5</td>
      <td>oc</td>
    </tr>
  </tbody>
</table>

<h4 id="example-3-start_index-and-end_index-are-negative">Example 3: <code class="highlighter-rouge">start_index</code> and <code class="highlighter-rouge">end_index</code> are negative</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>foo</td>
      <td>13</td>
    </tr>
    <tr>
      <td>overflow</td>
      <td>7</td>
    </tr>
    <tr>
      <td>some_text</td>
      <td>20</td>
    </tr>
    <tr>
      <td>a_word</td>
      <td>1</td>
    </tr>
    <tr>
      <td>toucan</td>
      <td>10</td>
    </tr>
    <tr>
      <td>toco</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'substring'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Label'</span><span class="p">,</span>
  <span class="nx">start_index</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>
  <span class="nx">end_index</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value</th>
      <th>Label_PCT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>foo</td>
      <td>13</td>
      <td>foo</td>
    </tr>
    <tr>
      <td>overflow</td>
      <td>7</td>
      <td>low</td>
    </tr>
    <tr>
      <td>some_text</td>
      <td>20</td>
      <td>ext</td>
    </tr>
    <tr>
      <td>a_word</td>
      <td>1</td>
      <td>ord</td>
    </tr>
    <tr>
      <td>toucan</td>
      <td>10</td>
      <td>can</td>
    </tr>
    <tr>
      <td>toco</td>
      <td>5</td>
      <td>oco</td>
    </tr>
  </tbody>
</table>

<h3 id="text-step"><code class="highlighter-rouge">text</code> step</h3>

<p>Use this step to add a text column where every value will be equal to the
specified <code class="highlighter-rouge">text</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'text'</span><span class="p">,</span>
    <span class="nx">new_column</span><span class="p">:</span> <span class="s1">'new'</span><span class="p">,</span> <span class="c1">// if the column already exists, overwrites it</span>
    <span class="nx">text</span><span class="p">:</span> <span class="s1">'some text'</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-18">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'text'</span><span class="p">,</span>
  <span class="nx">new_column</span><span class="p">:</span> <span class="s1">'KPI'</span><span class="p">,</span>
  <span class="nx">text</span><span class="p">:</span> <span class="s1">'Sales'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Value1</th>
      <th>KPI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>10</td>
      <td>Sales</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>1</td>
      <td>Sales</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>5</td>
      <td>Sales</td>
    </tr>
  </tbody>
</table>

<h3 id="todate-step"><code class="highlighter-rouge">todate</code> step</h3>

<p>Converts a string <code class="highlighter-rouge">column</code> into a date column based on a specified <code class="highlighter-rouge">format</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">name</span><span class="p">:</span> <span class="s1">'todate'</span><span class="p">,</span>
    <span class="nx">column</span><span class="p">:</span> <span class="s1">'myTextColumn'</span>
    <span class="nx">format</span><span class="p">:</span> <span class="s1">'%Y-%m-%d'</span> <span class="c1">// Optional. If undefined, the backend tries to infer the date format.</span>
                       <span class="c1">// For further details on supported format specifiers,</span>
                       <span class="c1">// see https://docs.mongodb.com/manual/reference/operator/aggregation/dateFromString/#datefromstring-format-specifiers</span>
                       <span class="c1">// Note: custom format is not supported in Mongo versions older than 4.0</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-19">Example</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Date</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>06/10/2019</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>07/10/2019</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>08/10/2019</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>06/10/2019</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>07/10/2019</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>08/10/2019</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'todate'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Date'</span><span class="p">,</span>
  <span class="nx">format</span><span class="p">:</span> <span class="s1">'%d/%m/%Y'</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Date</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>2019-10-06T00:00:00.000Z</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>2019-10-07T00:00:00.000Z</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>2019-10-08T00:00:00.000Z</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>2019-10-06T00:00:00.000Z</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>2019-10-07T00:00:00.000Z</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>2019-10-08T00:00:00.000Z</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<h3 id="top-step"><code class="highlighter-rouge">top</code> step</h3>

<p>Return top N rows by group if <code class="highlighter-rouge">groups</code> is specified, else over full dataset.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">,</span>
  <span class="nx">groups</span><span class="p">:</span> <span class="p">[</span><span class="s1">'foo'</span><span class="p">],</span>
  <span class="nx">rank_on</span><span class="p">:</span> <span class="s1">'bar'</span><span class="p">,</span>
  <span class="nx">sort</span><span class="p">:</span> <span class="s1">'desc'</span><span class="p">,</span> <span class="c1">// or 'asc'</span>
  <span class="nx">limit</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-1-top-without-groups-ascending-order">Example 1: top without <code class="highlighter-rouge">groups</code>, ascending order</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">,</span>
  <span class="nx">rank_on</span><span class="p">:</span> <span class="s1">'Value'</span><span class="p">,</span>
  <span class="nx">sort</span><span class="p">:</span> <span class="s1">'asc'</span><span class="p">,</span>
  <span class="nx">limit</span><span class="p">:</span> <span class="mi">3</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
  </tbody>
</table>

<h4 id="example-2-top-with-groups-descending-order">Example 2: top with <code class="highlighter-rouge">groups</code>, descending order</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 4</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Label 6</td>
      <td>Group 2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'top'</span><span class="p">,</span>
  <span class="nx">groups</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Group'</span><span class="p">],</span>
  <span class="nx">rank_on</span><span class="p">:</span> <span class="s1">'Value'</span><span class="p">,</span>
  <span class="nx">sort</span><span class="p">:</span> <span class="s1">'desc'</span><span class="p">,</span>
  <span class="nx">limit</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Company</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 5</td>
      <td>Group 2</td>
      <td>10</td>
    </tr>
  </tbody>
</table>

<h3 id="unpivot-step"><code class="highlighter-rouge">unpivot</code> step</h3>

<p>Unpivot a list of columns to rows.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'unpivot'</span><span class="p">,</span>
  <span class="nx">keep</span><span class="p">:</span> <span class="p">[</span><span class="s1">'COMPANY'</span><span class="p">,</span> <span class="s1">'COUNTRY'</span><span class="p">],</span> <span class="c1">// columns to keep fixed around which to unpivot columns</span>
  <span class="nx">unpivot</span><span class="p">:</span> <span class="p">[</span><span class="s1">'NB_CLIENTS'</span><span class="p">,</span> <span class="s1">'REVENUES'</span><span class="p">],</span> <span class="c1">// columns to unpivot</span>
  <span class="nx">unpivot_column_name</span><span class="p">:</span> <span class="s1">'KPI'</span><span class="p">,</span> <span class="c1">// name of the new dimension column created after unpivot</span>
  <span class="nx">value_column_name</span><span class="p">:</span> <span class="s1">'VALUE'</span><span class="p">,</span> <span class="c1">// name of the new value column created after unpivot</span>
  <span class="nx">dropna</span><span class="p">:</span> <span class="kc">true</span> <span class="c1">// whether null values have to be kept or the corresponding rows discarded</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-1-with-dropnaparameter-to-true">Example 1: with <code class="highlighter-rouge">dropna</code>parameter to true</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>COMPANY</th>
      <th>COUNTRY</th>
      <th>NB_CLIENTS</th>
      <th>REVENUES</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>France</td>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>France</td>
      <td>2</td>
      <td> </td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>USA</td>
      <td>12</td>
      <td>6</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>USA</td>
      <td>1</td>
      <td>3</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'unpivot'</span><span class="p">,</span>
  <span class="nx">keep</span><span class="p">:</span> <span class="p">[</span><span class="s1">'COMPANY'</span><span class="p">,</span> <span class="s1">'COUNTRY'</span><span class="p">],</span>
  <span class="nx">unpivot</span><span class="p">:</span> <span class="p">[</span><span class="s1">'NB_CLIENTS'</span><span class="p">,</span> <span class="s1">'REVENUES'</span><span class="p">],</span>
  <span class="nx">unpivot_column_name</span><span class="p">:</span> <span class="s1">'KPI'</span><span class="p">,</span>
  <span class="nx">value_column_name</span><span class="p">:</span> <span class="s1">'VALUE'</span><span class="p">,</span>
  <span class="nx">dropna</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>COMPANY</th>
      <th>COUNTRY</th>
      <th>KPI</th>
      <th>VALUE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>France</td>
      <td>NB_CLIENTS</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>France</td>
      <td>REVENUES</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>France</td>
      <td>NB_CLIENTS</td>
      <td>2</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>USA</td>
      <td>NB_CLIENTS</td>
      <td>12</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>USA</td>
      <td>REVENUES</td>
      <td>6</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>USA</td>
      <td>NB_CLIENTS</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>USA</td>
      <td>REVENUES</td>
      <td>3</td>
    </tr>
  </tbody>
</table>

<h4 id="example-1-with-dropnaparameter-to-false">Example 1: with <code class="highlighter-rouge">dropna</code>parameter to false</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>COMPANY</th>
      <th>COUNTRY</th>
      <th>NB_CLIENTS</th>
      <th>REVENUES</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>France</td>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>France</td>
      <td>2</td>
      <td> </td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>USA</td>
      <td>12</td>
      <td>6</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>USA</td>
      <td>1</td>
      <td>3</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'unpivot'</span><span class="p">,</span>
  <span class="nx">keep</span><span class="p">:</span> <span class="p">[</span><span class="s1">'COMPANY'</span><span class="p">,</span> <span class="s1">'COUNTRY'</span><span class="p">],</span>
  <span class="nx">unpivot</span><span class="p">:</span> <span class="p">[</span><span class="s1">'NB_CLIENTS'</span><span class="p">,</span> <span class="s1">'REVENUES'</span><span class="p">],</span>
  <span class="nx">unpivot_column_name</span><span class="p">:</span> <span class="s1">'KPI'</span><span class="p">,</span>
  <span class="nx">value_column_name</span><span class="p">:</span> <span class="s1">'VALUE'</span><span class="p">,</span>
  <span class="nx">dropna</span><span class="p">:</span> <span class="kc">false</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>COMPANY</th>
      <th>COUNTRY</th>
      <th>KPI</th>
      <th>VALUE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Company 1</td>
      <td>France</td>
      <td>NB_CLIENTS</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>France</td>
      <td>REVENUES</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>France</td>
      <td>NB_CLIENTS</td>
      <td>2</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>France</td>
      <td>REVENUES</td>
      <td> </td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>USA</td>
      <td>NB_CLIENTS</td>
      <td>12</td>
    </tr>
    <tr>
      <td>Company 1</td>
      <td>USA</td>
      <td>REVENUES</td>
      <td>6</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>USA</td>
      <td>NB_CLIENTS</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Company 2</td>
      <td>USA</td>
      <td>REVENUES</td>
      <td>3</td>
    </tr>
  </tbody>
</table>

<h3 id="uppercase-step"><code class="highlighter-rouge">uppercase</code> step</h3>

<p>Converts a string <code class="highlighter-rouge">column</code> to uppercase.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'uppercase'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'foo'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-20">Example:</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'uppercase'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="s1">'Label'</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>LABEL 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>LABEL 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>LABEL 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
  </tbody>
</table>

<h3 id="uniquegroups-step"><code class="highlighter-rouge">uniquegroups</code> step</h3>

<p>Allow to get unique groups of values from one or several columns.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'uniquegroups'</span><span class="p">,</span>
  <span class="nx">on</span><span class="p">:</span> <span class="p">[</span><span class="s1">'foo'</span><span class="p">,</span> <span class="s1">'bar'</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>This step is supported by the following backends:</strong></p>

<ul>
  <li>Mongo 4.0</li>
  <li>Mongo 3.6</li>
</ul>

<h4 id="example-21">Example:</h4>

<p><strong>Input dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
      <td>13</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>7</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>20</td>
    </tr>
    <tr>
      <td>Label 1</td>
      <td>Group 2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
      <td>3</td>
    </tr>
  </tbody>
</table>

<p><strong>Step configuration:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="s1">'uniquegroups'</span><span class="p">,</span>
  <span class="nx">column</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Label'</span><span class="p">,</span> <span class="s1">'Group'</span><span class="p">],</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output dataset:</strong></p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Label 1</td>
      <td>Group 1</td>
    </tr>
    <tr>
      <td>Label 1</td>
      <td>Group 2</td>
    </tr>
    <tr>
      <td>Label 2</td>
      <td>Group 1</td>
    </tr>
    <tr>
      <td>Label 3</td>
      <td>Group 1</td>
    </tr>
  </tbody>
</table>
</div>
            





  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  
    <ul class="pager">
      
        
        
        <li class="previous">
          <a href="/docs/index/">
            <span aria-hidden="true">&larr;</span> Previous
          </a>
        </li>
      

      
        
        
        <li class="next">
          <a href="/docs/new-step/">
            Next <span aria-hidden="true">&rarr;</span>
          </a>
        </li>
      
      </ul>
    <div class="clear"></div>
    

        </div>

    </div>
</div>

        </div>
    </div>

    <footer class="footer">
    <div class="container">

        <p class="text-center">
            Weaverbird 2020 |
            Powered by <a href="https://github.com/aksakalli/jekyll-doc-theme">Jekyll Doc Theme</a>
        </p>
        <!-- <p class="text-muted">Place sticky footer content here.</p> -->
    </div>
</footer>

    <script>
  var baseurl = ''
</script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script src="/js/bootstrap.min.js "></script>
<script src="/js/typeahead.bundle.min.js "></script>

<script src="/js/main.js "></script>

</body>

</html>
